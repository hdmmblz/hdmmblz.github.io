<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="最近好多题没补，慢慢来吧。包括一些开火车和一些$atcoder$，有一些题队友@yangdavid已经写过了，我就不用再浪费时间了。由于不是训练实录，有些水题就不写了 待补任务： 1.$opentrains1538GJ$啃$std$">
<meta property="og:type" content="article">
<meta property="og:title" content="补题、杂题N合1">
<meta property="og:url" content="http://yoursite.com/2019/04/28/补题、杂题N合1/index.html">
<meta property="og:site_name" content="hdmmblz异闻录">
<meta property="og:description" content="最近好多题没补，慢慢来吧。包括一些开火车和一些$atcoder$，有一些题队友@yangdavid已经写过了，我就不用再浪费时间了。由于不是训练实录，有些水题就不写了 待补任务： 1.$opentrains1538GJ$啃$std$">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-05-02T11:01:19.764Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="补题、杂题N合1">
<meta name="twitter:description" content="最近好多题没补，慢慢来吧。包括一些开火车和一些$atcoder$，有一些题队友@yangdavid已经写过了，我就不用再浪费时间了。由于不是训练实录，有些水题就不写了 待补任务： 1.$opentrains1538GJ$啃$std$">





  
  
  <link rel="canonical" href="http://yoursite.com/2019/04/28/补题、杂题N合1/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>补题、杂题N合1 | hdmmblz异闻录</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">hdmmblz异闻录</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">qwq</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-schedule">

    
    
    
      
    

    

    <a href="/schedule/" rel="section"><i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>日程表</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/28/补题、杂题N合1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hdmmblz">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hdmmblz异闻录">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">补题、杂题N合1

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-04-28 20:07:51" itemprop="dateCreated datePublished" datetime="2019-04-28T20:07:51+08:00">2019-04-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-05-02 19:01:19" itemprop="dateModified" datetime="2019-05-02T19:01:19+08:00">2019-05-02</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>最近好多题没补，慢慢来吧。包括一些开火车和一些$atcoder$，有一些题队友@yangdavid已经写过了，我就不用再浪费时间了。由于不是训练实录，有些水题就不写了</p>
<p>待补任务：</p>
<p>1.$opentrains1538GJ$啃$std$</p>
  <a id="more"></a> 
<h2 id="opentrains-1483-E-Expected-LCP"><a href="#opentrains-1483-E-Expected-LCP" class="headerlink" title="opentrains 1483 E.Expected LCP"></a>opentrains 1483 E.Expected LCP</h2><p>题目：有$n$个长度无穷的$0/1$串<br>$$<br>f_n=max_{i \ne j}{LCP(s_i,s_j)}<br>$$<br>求$f_n$的期望。</p>
<p>solution：</p>
<p>首先，我们可以确定一个$p\ge1$,使得存在一种方式使得$f_n&lt;p$</p>
<p>这样的话，说明$f_n$至少是$p-1$先把这部分加上去</p>
<p>考虑，$P(i)=P(f_n=i)=\frac{A^n_{2^{i+1}}}{2^{(i+1)n}}-\frac{A^n_{2^{i}}}{2^{in}}$，设$b_i=\frac{A^n_{2^{i}}}{2^{in}}$<br>$$<br>E(f_n)=contribution(p-1)+\sum_{i=p}^{\infty}i(b_{i+1}-b_i)=contribution(p-1)-ib_i-\sum_{i={p+1}}^{\infty}b_i<br>$$<br>考虑如何计算$\sum_{i={p+1}}^{\infty}b_i$，设$x_i=2^i$<br>$$<br>b_i=\frac{\prod_{j=0}^{n-1}x_i-j}{x_i^n}=F(\frac{1}{x_i})<br>$$<br>其中$F(x)=\sum_{i=0}^na_ix^i$是一个$n$次多项式</p>
<p>对于每一个$i$，$B_i=\sum_{j=p+1}^{\infty}a_i\frac{1}{x_j^i}$都是一个无穷等比数列求和形式，将每个$B_i$都求出来，则$\sum_{i={p+1}}^{\infty}b_i=\sum_{i=0}^nB_i$。由于$n$有限，因此是对的</p>
<p>启示：当遇到难以处理的数列求和时，可考虑把数列看成多项式形式，对每一项分别求和</p>
<h2 id="opentrains-1538-I-Modulo-magic-squares"><a href="#opentrains-1538-I-Modulo-magic-squares" class="headerlink" title="opentrains 1538 I.Modulo-magic squares"></a>opentrains 1538 I.Modulo-magic squares</h2><p>有一个$n^2$的矩阵，矩阵元素是$[0,m-1]$,求有多少个合法矩阵，满足每一行、每一列、主对角线、副对角线的元素和在模$m$意义下都是一个常数$C$？</p>
<p>$solution$:考虑有多少个自由元，然后答案就是$m^{自由元个数}$</p>
<p>自由元个数：$1(选择C)+(n-1)(n-2)(随意选择前n-2行的前n-1列的每个数字)+(n-3)(选择倒数第二行的除第一列、最后一列、第三列的所有元素)=n^2-2n$</p>
<p>这样，我们用第二项中的$n^2-3n+2$个自由元确定了前$(n-2)$行，用倒数第二行的第二列和倒数第二列两个自由元确定了主副对角线和第一、二、倒数第一、倒数第二列。然后我们用倒数第二行的其他自由元确定了倒数第二行和其他所有的列，至于倒数第一行，由于我们已经确保所有列和其他所有行成立，用二次求和法对矩阵所有元素求和即可证倒数第一行也成立</p>
<p>$ans=m^{n^2-2n}$</p>
<p>以上构造方法对$n\ge5$均成立</p>
<p>手推可知对$n\leq3$也成立</p>
<p>对于$n=4$,我们发现，倒数第二行倒数第二列的取值满足一个可写为$2x=K(mod\ m)$的方程。在$m$为奇数时，取$2$的逆元则有唯一解，这时满足上述公式，但在$m$为偶数时，若$K$为偶数则有两个解否则没有解，打表或经过超高校级麻烦的分类讨论可以发现，$K$不可能为奇数。因此，唯一的特例是，当$n=4,2|m$时：</p>
<p>$ans=2m^{n^2-2n}$</p>
<h2 id="Atcoder-AGC010"><a href="#Atcoder-AGC010" class="headerlink" title="Atcoder AGC010"></a>Atcoder AGC010</h2><p>非常棒的一场，三道操作题三道博弈论，很自闭但真的很有趣，由于官方题解很详细了就不再赘述。</p>
<h2 id="opentrains1519"><a href="#opentrains1519" class="headerlink" title="opentrains1519"></a>opentrains1519</h2><p>A.线段树优化建图+强连通分量，B.签到，D.递归优化 F.二维数点 G.最小圆覆盖 H.状压 见@yangdavid博客，不再重新叙述</p>
<p>其中$H$是一道不错的状压</p>
<h3 id="K-Knapsack"><a href="#K-Knapsack" class="headerlink" title="K.Knapsack"></a>K.Knapsack</h3><p>这时$Claris$讲课时说的那个随机凸包期望$logn$的随机背包神题，由于也不知道证明，也不是很了解，就不细讲，听$Claris$课即可</p>
<h3 id="I-Statistics"><a href="#I-Statistics" class="headerlink" title="I.Statistics"></a>I.Statistics</h3><p>给出 $n≤5000$个物品，第 $i$个物品的体积为$v_i$ ，求所有体积和<strong>恰</strong>为$1≤V≤5000$且物品数量<strong>最小</strong>的集合中，最小的平均体积，最小的中位数（偶数的中位数是中间靠左的一个），最小的众数个数，最小的极差</p>
<p>下面我们一个一个说：</p>
<p>首先我们得做一遍普通背包得知体积恰为$V$最少多少个物品，设为$m$个</p>
<p>平均值：直接算，$O(1)$</p>
<p>中位数：</p>
<p>算法一：做前缀背包和后缀背包并枚举中位数，检查是否合法时枚举集合种比中位数小的背包体积和，复杂度$nV$,常数为$3$</p>
<p>算法二：二分中位数，把每个物品价值变成$inf+(-1)^{[v_i&lt;mid]}$，做体积固定价值最小的背包，若结果大于$m·mid$则当前中位数过小，否则过大。此方法虽然多一个$log$，但巧妙地通过$inf$把物品数量最小的限制转化掉了，感觉挺有启发</p>
<p>众数：</p>
<p>算法一：二分答案然后做背包，复杂度$O(nVlogn)$</p>
<p>算法二：从小到达枚举众数，每次把可以增加的物品加入背包，复杂度$O(nV)$</p>
<p>极差：</p>
<p>极差是这道题目的精华，两个算法都很有启发性</p>
<p>算法一：将物品按照$v_i$排序后，考虑滑动窗口，滑动窗口里是要满足<strong>存在一个大小为$m$的子集使得体积和为$V$</strong>,我们现在这样支持添加物品和删除物品：维护两个栈，栈的每个元素都是一个长度为$V$的代表背包的数组，共需要$V^2$空间，当我们加入一个物品时，直接加在$A$栈栈顶，用原来$A$栈栈顶的背包更新构成新栈顶，如果我们要删除一个物品（这个物品是当前区间的第一位），这时如果栈$B$不为空，说明要删除的东西是栈$B$栈顶，那么直接将栈$B$的栈顶弹出即可，如果栈$B$是空的，说明要删除的物品是栈底，这时，我们将$A$除了栈底以外的元素一个个弹出，并按照弹出的顺序一个个加入栈$B$并做背包即可。</p>
<p>我们发现，栈$A$从顶到底元素的$v_i$减小，栈$B$从底到顶元素的$v_i$减小</p>
<p>要查询整个背包某一项，直接合并$A、B$栈顶所代表的背包即可，合并一次复杂度$O(V)$</p>
<p>势能分析可得这样做维护两个栈背包的时间是$O(nV)$</p>
<p>以上方法可以处理所有滑动窗口背包、$n$次查询背包某一个值的问题</p>
<p>算法二：按照$v_i$从小到大加入背包，把物品价值设为$inf-v_i$(更新$dp[v_i]$时)，$inf$（其他时候），枚举最大值直接查询即可，不得不说这个方法也很棒。</p>
<p>总复杂度$O(nV)$</p>
<h3 id="C-Flip-a-coin"><a href="#C-Flip-a-coin" class="headerlink" title="C.Flip a coin"></a>C.Flip a coin</h3><p>有两个人，他们分别拥有 $0/1$ 串$s$ 和$t$。现在不停地掷一枚均匀的硬币，正面为 $1$，反面为 $0$。如果某一时刻硬币组成的串中包含 $s$，那么第一个人赢；如果包含 $t$，那么第二个人赢；如果同时包含$s,t$，那么平局。问这三种情况的概率。 </p>
<p>字符串长度小于$50$</p>
<p>$solution$:游戏不停止$0/1$串就会不停写下去</p>
<p>算法一：我们设一个零一串$S$的“产生价值”为$f(S)=2^{-|S|}$</p>
<p>求出两个串的前缀$border$数组</p>
<p>我们设$dp[i][j]$表示所有内部不包括$s/t$为子串，且$s、t$的后缀$KMP$状态分别是$i,j$的$0/1$串的价值和</p>
<p>然后我们做高斯消元即可，复杂度$O(n^6)$</p>
<p>算法二：跟上一个算法一样，不过这次，我们建出$s、t$的$AC$自动机，我们的$dp$状态是：所有$s/t$都没有出现过，且后缀状态在$AC$自动机的特定节点上的字符串的价值和，也是一样的高斯消元，只是这次的复杂度为$O((n+m)^3)$</p>
<p>算法三：这道题原题是让输出小数，因此我们怕高斯消元精度不够，这时我们还是考虑$n+m$个$AC$自动机的状态，用他们之间的转移构造出矩阵，跑一个非常大的矩阵快速幂来逼近精确值即可（可理解为串是有限长的，但长度非常长）。复杂度$O((n+m)^3log10^{18})$</p>
<h3 id="E-Tree-Paths"><a href="#E-Tree-Paths" class="headerlink" title="E.Tree Paths"></a>E.Tree Paths</h3><p>一个点的点权就是它的编号，求一棵树上有多少条路径使得$max-min=len$</p>
<p>$n\leq10^5$</p>
<p>考虑点分治，每次计数经过分治中心的路径，在每个点分数中$dfs$，求出每个点$x$到分治中心的路径上的$max,min,len$，然后，我们考虑，对这个分治中心的每个儿子的子树里的点维护一个树状数组，对这棵分治树里的所有点维护一个树状数组，这些树状数组以某种需要的值为下标，记录满足该值的元素的数量。在这里，每条我们要考虑的树链都是由两条来自不同子树的树链拼合而成的（要经过分治中心）。为了满足来自不同子树的性质，我们只需要用在全局树状数组中查询的结果，减去在当前子树代表的树状数组中查询的结果，便是合法的结果。以下我们仅叙述要怎么在某个数据结构中查询合法的数量。</p>
<p>我们首先考虑$max$和$min$都处在两条树链中某一条上的情况数，考虑枚举这条又有$max$又有$min$的链，首先他得满足$max-min=len$，我们称这样的链为合法链,这样，我们按照$min$从大到小考虑每个点，如果这个点代表的链是合法链，我们就考虑有多条链$v$，满足$max_v&lt;max$,因此在这里我们的树状数组的下标应为$max$，这一步等价于一个离线二维数点的过程</p>
<p>接下来我们考虑$max$和$min$分别咋链$a,b$上，这样我们就有$max_a-len_a=min_b+len_b$,这样，我们对每条链就有两个属性$f(a)=max_a-len_a,g(a)=min_a+len+a$，我们把每条链的两个属性看成是两个链，分别是一类链和二类链，我们把所有的$2n$个链按照权值排序，由于每个合法的组合都是两个权值相同的、一个一类一个二类两条链组成，我们按照权值一批一批考虑，在每一批中我们都按照$min$从小到大考虑，每枚举到一个一类链，我们去树状数组中查询$max_v&lt;max$的二类链的数量，这样就做完了。</p>
<p>回顾这个解法：首先，我们用全局树状数组和分子树树状数组保证了来自不同子树这一限制，从而使我们可以随意决定枚举点的顺序，其次，在第一步中，二维数点思维含量不高，第二步中，我们首先用权值限制了所需等式，又用按照$min$从小到大枚举这一顺序限制了$min$的大小关系，这样就只有$max$的大小关系需要使用数据结构维护。我们将$1.不同子树 2.min 3.max 4.max-min=len$四个限制最终化简到只需考虑一个限制</p>
<p>复杂度$O(nlog^2n)$</p>
<p>以上为口胡，这次是个例外，代码完成后会将代码给出。</p>
<h3 id="J-Zigzag"><a href="#J-Zigzag" class="headerlink" title="J.Zigzag"></a>J.Zigzag</h3><p>求两个数列的最长公共波浪子序列。</p>
<p>数据范围：$n,m\leq5000$</p>
<p>这题一点都不难，第一次听题的时候yd讲错题意了（<del>要不就是我自己听错了</del>）</p>
<p>$O(nm)$的$dp$,方法跟进阶指南傻逼题$LCIS$(最长公共上升子序列)一毛一样</p>
<h2 id="opentrains1505-1491-1483"><a href="#opentrains1505-1491-1483" class="headerlink" title="opentrains1505/1491/1483"></a>opentrains1505/1491/1483</h2><h2 id="历史遗留问题："><a href="#历史遗留问题：" class="headerlink" title="历史遗留问题："></a>历史遗留问题：</h2><h2 id="opentrains1538J-Count-the-sequences"><a href="#opentrains1538J-Count-the-sequences" class="headerlink" title="opentrains1538J Count the sequences"></a>opentrains1538J Count the sequences</h2><p>给定四个数$n,b,c,m$求有多少个长度为$m$的整数数列${x}$满足：</p>
<p>$0\leq x_i\leq b^i-c$</p>
<p>$\sum_{i=1}^mx_i\leq n$</p>
<p>数据范围：</p>
<p>$1\leq m\leq 50,2\leq b\leq10^9,-b+2\leq c\leq b-1,n\leq b^{m+1}$</p>
<p>不是很会，大概有一个补集转化数位$dp$的想法，有时间再啃代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cassert&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mk make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, x, y) for(int i = (int)x; i &lt;= (int)y; i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(i, x, y) for(int i = (int)x; i &lt;  (int)y; i ++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PER(i, x, y) for(int i = (int)x; i &gt;= (int)y; i --)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> trace(x) cerr &lt;&lt; #x &lt;&lt; <span class="meta-string">" "</span> &lt;&lt; x &lt;&lt; endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> dprintf(...) fprintf(stderr, __VA__ARGS__)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> dln()        fprintf(stderr, <span class="meta-string">"\n"</span>)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; VI;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;PII&gt; VPI;</span><br><span class="line"><span class="keyword">const</span>    <span class="keyword">int</span> N = <span class="number">100005</span>;</span><br><span class="line"><span class="keyword">const</span>    <span class="keyword">int</span> P = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">const</span>    <span class="keyword">int</span> inf = <span class="number">1e9</span>;</span><br><span class="line"><span class="keyword">const</span>    LL Inf = <span class="number">1e15</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">IN</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar(); <span class="keyword">int</span> x = <span class="number">0</span>, f = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>) ch = getchar(), f = (ch == <span class="string">'-'</span>);</span><br><span class="line">    <span class="keyword">while</span>(ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>)&#123;</span><br><span class="line">        x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + ch - <span class="number">48</span>;</span><br><span class="line">        ch = getchar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f ? (-x) : x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Pow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> an = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; y; y &gt;&gt;= <span class="number">1</span>, x = (LL)x * x % p) <span class="keyword">if</span>(y &amp; <span class="number">1</span>) an = (LL)an * x % p;</span><br><span class="line">    <span class="keyword">return</span> an;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">renew</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    x = (x + y &gt;= P ? x + y - P : x + y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setIO</span><span class="params">(<span class="built_in">string</span> a)</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> LOCAL</span></span><br><span class="line">    freopen((a + <span class="string">".in"</span>).c_str(), <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    freopen((a + <span class="string">".out"</span>).c_str(), <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">    freopen(<span class="string">"1.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"1.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">chkmin</span><span class="params">(T &amp;a, <span class="keyword">const</span> T &amp;b)</span> </span>&#123;<span class="keyword">if</span>(a &gt; b) a = b;&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">chkmax</span><span class="params">(T &amp;a, <span class="keyword">const</span> T &amp;b)</span> </span>&#123;<span class="keyword">if</span>(a &lt; b) a = b;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> m, b, c;</span><br><span class="line"><span class="keyword">int</span> len, fac[<span class="number">55</span>];</span><br><span class="line"><span class="keyword">char</span> str[<span class="number">100005</span>];</span><br><span class="line"><span class="keyword">int</span> dig[<span class="number">100005</span>], stk[<span class="number">100005</span>], top;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Mod</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> x = <span class="number">0</span>;</span><br><span class="line">    PER(i, len, <span class="number">1</span>)&#123;</span><br><span class="line">        x = (x * <span class="number">10</span> + dig[i]);</span><br><span class="line">        dig[i] = x / b;</span><br><span class="line">        x %= b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(len &amp;&amp; dig[len] == <span class="number">0</span>) len --;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dp[<span class="number">55</span>][<span class="number">55</span>][<span class="number">55</span>];</span><br><span class="line"><span class="keyword">int</span> pw[<span class="number">55</span>][<span class="number">55</span>];</span><br><span class="line"><span class="keyword">int</span> ifac[<span class="number">55</span>];</span><br><span class="line"><span class="keyword">int</span> ans[<span class="number">55</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">    stk[<span class="number">0</span>] -= c;</span><br><span class="line">    <span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(stk[now] &gt;= b)&#123;</span><br><span class="line">        stk[now] -= b;</span><br><span class="line">        stk[now + <span class="number">1</span>] ++;</span><br><span class="line">        now ++;</span><br><span class="line">    &#125;</span><br><span class="line">    top = max(top, now + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fu;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Minus</span><span class="params">()</span></span>&#123;</span><br><span class="line">    stk[<span class="number">0</span>] -= c;</span><br><span class="line">    <span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(now &lt; top &amp;&amp; stk[now] &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        stk[now] += b;</span><br><span class="line">        stk[now + <span class="number">1</span>] --;</span><br><span class="line">        now ++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(now &gt;= top)&#123;</span><br><span class="line">        fu = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(top &amp;&amp; stk[top - <span class="number">1</span>] == <span class="number">0</span>) top --;</span><br><span class="line">    <span class="keyword">if</span>(!top)&#123;</span><br><span class="line">        fu = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cf[<span class="number">55</span>], ncf[<span class="number">55</span>];</span><br><span class="line"><span class="keyword">int</span> cmod;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">clear_all</span><span class="params">()</span></span>&#123;</span><br><span class="line">    len = top = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(stk, <span class="number">0</span>, <span class="keyword">sizeof</span> stk);</span><br><span class="line">    <span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="keyword">sizeof</span> str);</span><br><span class="line">    <span class="built_in">memset</span>(dig, <span class="number">0</span>, <span class="keyword">sizeof</span> dig);</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="keyword">sizeof</span> dp);</span><br><span class="line">    <span class="built_in">memset</span>(pw, <span class="number">0</span>, <span class="keyword">sizeof</span> pw);</span><br><span class="line">    <span class="built_in">memset</span>(ans, <span class="number">0</span>, <span class="keyword">sizeof</span> ans);</span><br><span class="line">    fu = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(cf, <span class="number">0</span>, <span class="keyword">sizeof</span> cf);</span><br><span class="line">    <span class="built_in">memset</span>(ncf, <span class="number">0</span>, <span class="keyword">sizeof</span> ncf);</span><br><span class="line">    cmod = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    clear_all();</span><br><span class="line"></span><br><span class="line">    c = <span class="number">1</span> - c;</span><br><span class="line">    cmod = (c % P + P) % P;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, str + <span class="number">1</span>);</span><br><span class="line">    </span><br><span class="line">    len = <span class="built_in">strlen</span>(str + <span class="number">1</span>);</span><br><span class="line">    REP(i, <span class="number">1</span>, len) dig[i] = str[i] - <span class="number">48</span>;</span><br><span class="line">    reverse(dig + <span class="number">1</span>, dig + len + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> nmod = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(len &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        stk[top] = Mod();</span><br><span class="line">        top ++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    PER(i, top - <span class="number">1</span>, <span class="number">0</span>)&#123;</span><br><span class="line">        nmod = ((LL)nmod * b + stk[i]) % P;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    nmod = (nmod + P - <span class="number">1</span> + m) % P;</span><br><span class="line"></span><br><span class="line">    REP(i, <span class="number">0</span>, m) pw[<span class="number">0</span>][i] = ifac[i];</span><br><span class="line"></span><br><span class="line">    REP(i, <span class="number">1</span>, m)&#123;</span><br><span class="line">        pw[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> ww = Pow(b, i, P);</span><br><span class="line">        REP(j, <span class="number">1</span>, m) pw[i][j] = (LL)pw[i][j - <span class="number">1</span>] * ww % P;</span><br><span class="line">        REP(j, <span class="number">0</span>, m) pw[i][j] = (LL)pw[i][j] * ifac[j] % P;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dp[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    REP(i, <span class="number">1</span>, m)&#123;</span><br><span class="line">        REP(j, <span class="number">0</span>, i) REP(k, <span class="number">0</span>, m)&#123;</span><br><span class="line">            <span class="keyword">const</span> <span class="keyword">int</span> val = dp[i][j][k];</span><br><span class="line">            <span class="keyword">if</span>(!val) <span class="keyword">continue</span>;</span><br><span class="line">            renew(dp[i + <span class="number">1</span>][j][k], val);</span><br><span class="line">            REP(t, <span class="number">0</span>, m - k)&#123;</span><br><span class="line">                <span class="keyword">int</span> ddd = (t &amp; <span class="number">1</span> ? P - pw[i][t] : pw[i][t]);</span><br><span class="line">                renew(dp[i + <span class="number">1</span>][j + <span class="number">1</span>][k + t], (LL)val * ddd % P);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    REP(cho, <span class="number">0</span>, m)&#123;</span><br><span class="line">        <span class="keyword">if</span>(fu) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">int</span> nowmod = nmod;</span><br><span class="line">        <span class="keyword">int</span> nowcho = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(top - <span class="number">1</span> &gt; m)&#123;</span><br><span class="line">            <span class="keyword">int</span> xmod = nowmod;</span><br><span class="line">            <span class="keyword">int</span> *xdp = dp[m + <span class="number">1</span>][cho];</span><br><span class="line">            <span class="keyword">int</span> xx = (cho &amp; <span class="number">1</span> ? P - <span class="number">1</span> : <span class="number">1</span>);</span><br><span class="line">            REP(a, <span class="number">0</span>, m)&#123;</span><br><span class="line">                <span class="keyword">int</span> gt = (LL)xx * ifac[a] % P;</span><br><span class="line">                REP(b, <span class="number">0</span>, m - a) &#123;</span><br><span class="line">                    ans[a + b] = (ans[a + b] + ((LL)xdp[b] * gt)) % P;</span><br><span class="line">                &#125;</span><br><span class="line">                xx = (LL)xx * xmod % P;</span><br><span class="line">            &#125;</span><br><span class="line">            nmod = (nmod + P - cmod) % P;</span><br><span class="line">            <span class="keyword">if</span>(c &gt; <span class="number">0</span>) Minus();</span><br><span class="line">            <span class="keyword">else</span> add();</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        PER(i, top - <span class="number">1</span>, <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(stk[i] &gt; <span class="number">1</span> &amp;&amp; i != <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> xmod = (nowmod + P - pw[i][<span class="number">1</span>]) % P;</span><br><span class="line">                <span class="keyword">int</span> xcho = nowcho + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>(xcho &lt;= cho)&#123;</span><br><span class="line">                    <span class="keyword">int</span> *xdp = dp[i][cho - xcho];</span><br><span class="line">                    <span class="keyword">int</span> xx = (cho &amp; <span class="number">1</span> ? P - <span class="number">1</span> : <span class="number">1</span>);</span><br><span class="line">                    REP(a, <span class="number">0</span>, m)&#123;</span><br><span class="line">                        <span class="keyword">int</span> gt = (LL)xx * ifac[a] % P;</span><br><span class="line">                        REP(b, <span class="number">0</span>, m - a) &#123;</span><br><span class="line">                            ans[a + b] = (ans[a + b] + ((LL)xdp[b] * gt)) % P;</span><br><span class="line">                        &#125;</span><br><span class="line">                        xx = (LL)xx * xmod % P;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(stk[i] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> xmod = nowmod;</span><br><span class="line">                <span class="keyword">int</span> xcho = nowcho;</span><br><span class="line">                <span class="keyword">if</span>(xcho &lt;= cho)&#123;</span><br><span class="line">                    <span class="keyword">int</span> *xdp = dp[i][cho - xcho];</span><br><span class="line">                    <span class="keyword">int</span> xx = (cho &amp; <span class="number">1</span> ? P - <span class="number">1</span> : <span class="number">1</span>);</span><br><span class="line">                    REP(a, <span class="number">0</span>, m)&#123;</span><br><span class="line">                        <span class="keyword">int</span> gt = (LL)xx * ifac[a] % P;</span><br><span class="line">                        REP(b, <span class="number">0</span>, m - a) &#123;</span><br><span class="line">                            ans[a + b] = (ans[a + b] + ((LL)xdp[b] * gt)) % P;</span><br><span class="line">                        &#125;</span><br><span class="line">                        xx = (LL)xx * xmod % P;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(stk[i] &gt; <span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">if</span>(stk[i])&#123;</span><br><span class="line">                nowmod = (nowmod + P - pw[i][<span class="number">1</span>]) % P;</span><br><span class="line">                nowcho += (stk[i] &gt; <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        nmod = (nmod + P - cmod) % P;</span><br><span class="line">        <span class="keyword">if</span>(c &gt; <span class="number">0</span>) Minus();</span><br><span class="line">        <span class="keyword">else</span> add();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cf[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">memset</span>(ncf, <span class="number">0</span>, <span class="keyword">sizeof</span> ncf);</span><br><span class="line">    REP(i, <span class="number">0</span>, m - <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">memcpy</span>(ncf, cf, <span class="keyword">sizeof</span> cf);</span><br><span class="line">        <span class="built_in">memset</span>(cf,  <span class="number">0</span>,  <span class="keyword">sizeof</span> cf);</span><br><span class="line">        REP(j, <span class="number">0</span>, i)&#123;</span><br><span class="line">            cf[j] = (cf[j] + (LL)ncf[j] * (P - i)) % P;</span><br><span class="line">            cf[j + <span class="number">1</span>] = (cf[j + <span class="number">1</span>] + ncf[j]) % P;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    REP(i, <span class="number">0</span>, m) cf[i] = (LL)cf[i] * ifac[m] % P;</span><br><span class="line">    REP(i, <span class="number">0</span>, m) res = (res + (LL)cf[i] * ans[i] % P * fac[i]) % P;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> cas = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, res); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ifac[<span class="number">0</span>] = fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    REP(i, <span class="number">1</span>, <span class="number">53</span>)&#123;</span><br><span class="line">        ifac[i] = (LL)ifac[i - <span class="number">1</span>] * Pow(i, P - <span class="number">2</span>, P) % P;</span><br><span class="line">        fac[i] = Pow(ifac[i], P - <span class="number">2</span>, P);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;m, &amp;b, &amp;c) != EOF) Main();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="opentrains1538G-String-transformation"><a href="#opentrains1538G-String-transformation" class="headerlink" title="opentrains1538G String transformation"></a>opentrains1538G String transformation</h2><p>给定一个长度为$10^5$的字符串，你可以随意操作，每次操作可以选择一个字母让他上一位，如$A-&gt;a,e-&gt;F,z-&gt;A$</p>
<p>问能否使得一番操作后字符串总共刚好有$k$个洞。（如$B$有两个洞，$p$有一个洞，$F$没有洞）</p>
<p>这题貌似分了好久种情况，代码也特别长，有时间啃啃</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">double</span> dbl;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = (<span class="keyword">int</span>) (<span class="number">1e9</span> + <span class="number">7</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> alph;</span><br><span class="line"><span class="keyword">int</span> cnt[<span class="number">333</span>];</span><br><span class="line"><span class="keyword">int</span> pos[<span class="number">333</span>];</span><br><span class="line"><span class="built_in">string</span> C[] = &#123; <span class="string">"CcEFfGHhIiJjKkLlMmNnrSsTtUuVvWwXxYyZz"</span>, <span class="string">"AabDdeOoPpQqR"</span>, <span class="string">"Bg"</span> &#125;;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">char</span>&gt; nr[<span class="number">52</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">item</span> &#123;</span></span><br><span class="line">  <span class="keyword">char</span> f, s;</span><br><span class="line">  <span class="keyword">int</span> v1, v2;</span><br><span class="line">  <span class="keyword">int</span> cost;</span><br><span class="line">  <span class="keyword">int</span> add;</span><br><span class="line"></span><br><span class="line">  item () &#123;&#125;</span><br><span class="line"></span><br><span class="line">  item (<span class="keyword">char</span> f, <span class="keyword">char</span> s, <span class="keyword">int</span> v1, <span class="keyword">int</span> v2, <span class="keyword">int</span> cost, <span class="keyword">int</span> add) : f (f), s (s), v1 (v1), v2 (v2), cost (cost), add (add) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> item &amp;it) <span class="keyword">const</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">abs</span> (add) != <span class="built_in">abs</span> (it.add)) <span class="keyword">return</span> <span class="built_in">abs</span> (add) &gt; <span class="built_in">abs</span> (it.add);</span><br><span class="line">    <span class="keyword">if</span> (cost != it.cost) <span class="keyword">return</span> cost &lt; it.cost;</span><br><span class="line">    <span class="keyword">return</span> mp (min (f, s), max (f, s)) &lt; mp (min (it.f, it.s), max (it.f, it.s));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">friend</span> ostream &amp;<span class="keyword">operator</span> &lt;&lt; (ostream &amp;<span class="built_in">cout</span>, <span class="keyword">const</span> item &amp;it) &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; it.f &lt;&lt; <span class="string">' '</span> &lt;&lt; it.s &lt;&lt; <span class="string">' '</span> &lt;&lt; it.v1 &lt;&lt; <span class="string">' '</span> &lt;&lt; it.v2 &lt;&lt; <span class="string">' '</span> &lt;&lt; it.add &lt;&lt; <span class="string">' '</span> &lt;&lt; it.cost;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">cout</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getDst</span> <span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> res = pos[b] - pos[a];</span><br><span class="line">  <span class="keyword">if</span> (res &lt; <span class="number">0</span>) res += alph.size ();</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">opt</span> <span class="params">(<span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &amp;t, <span class="keyword">int</span> k, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">auto</span> it = t.find (k);</span><br><span class="line">  <span class="keyword">if</span> (it == t.end ()) t[k] = v;</span><br><span class="line">  <span class="keyword">else</span> it -&gt; second = min (it -&gt; second, v);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">    alph += <span class="string">'A'</span> + i;</span><br><span class="line">    alph += <span class="string">'a'</span> + i;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> c : C[i]) &#123;</span><br><span class="line">      cnt[(<span class="keyword">int</span>)c] = i;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)alph.size (); i++) &#123;</span><br><span class="line">    pos[(<span class="keyword">int</span>)alph[i]] = i;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) alph.size (); i++) &#123;</span><br><span class="line">    <span class="keyword">int</span> C = cnt[(<span class="keyword">int</span>) alph[i]];</span><br><span class="line">    <span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; tmp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> c : alph) &#123;</span><br><span class="line">      <span class="keyword">int</span> df = cnt[(<span class="keyword">int</span>) c] - C;</span><br><span class="line">      opt (tmp, df, getDst (alph[i], c));       </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> it : tmp) &#123;</span><br><span class="line">      nr[i][it.first] = alph[(i + it.second) % alph.size ()];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="built_in">string</span> s;</span><br><span class="line">ll k;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span> <span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> shift)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v = s[id];</span><br><span class="line">  v = pos[v];</span><br><span class="line">  v += shift;</span><br><span class="line">  v %= alph.size ();</span><br><span class="line">  s[id] = alph[v];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">load</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">  <span class="built_in">cin</span> &gt;&gt; s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; CC;</span><br><span class="line"><span class="built_in">set</span>&lt;item&gt; Q;</span><br><span class="line"><span class="keyword">int</span> ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> c1 : alph) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> c2 : alph) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">auto</span> it1 : nr[pos[(<span class="keyword">int</span>) c1]]) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> it2 : nr[pos[(<span class="keyword">int</span>) c2]]) &#123;          </span><br><span class="line">          <span class="keyword">char</span> c3 = it1.second;</span><br><span class="line">          <span class="keyword">char</span> c4 = it2.second;</span><br><span class="line">          <span class="keyword">int</span> cnt1 = cnt[(<span class="keyword">int</span>) c1] + cnt[(<span class="keyword">int</span>) c2];</span><br><span class="line">          <span class="keyword">int</span> cnt2 = cnt[(<span class="keyword">int</span>) c3] + cnt[(<span class="keyword">int</span>) c4];</span><br><span class="line">          <span class="keyword">int</span> step = cnt2 - cnt1;</span><br><span class="line">          <span class="keyword">if</span> (<span class="built_in">abs</span> (step) &gt; <span class="number">2</span> || !step) <span class="keyword">continue</span>;</span><br><span class="line">          <span class="keyword">int</span> cost = getDst (c1, c3) + getDst (c2, c4);</span><br><span class="line">          <span class="function">item <span class="title">tmp</span> <span class="params">(c1, c2, getDst (c1, c3), getDst (c2, c4), cost, step)</span></span>;</span><br><span class="line">          Q.insert (tmp);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  CC.resize (alph.size ());</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> c : s) &#123;</span><br><span class="line">    CC[pos[(<span class="keyword">int</span>) c]]++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; PS[<span class="number">52</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; change (<span class="keyword">int</span> id, <span class="keyword">int</span> shift, <span class="keyword">int</span> cnt) &#123;</span><br><span class="line">  <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">  <span class="keyword">while</span> (cnt --&gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">int</span> I = PS[id].back ();</span><br><span class="line">    PS[id].pop_back ();</span><br><span class="line">    change (I, shift);</span><br><span class="line">    res.pb (I);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push</span> <span class="params">(<span class="keyword">int</span> id, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;ids)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> it : ids) PS[id].pb (it);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">recoveryInc</span> <span class="params">(<span class="keyword">int</span> diff)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> it : Q) &#123;</span><br><span class="line">    <span class="keyword">if</span> (it.add &lt; <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span> (it.add &gt; diff) <span class="keyword">continue</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> cnt = diff / it.add;</span><br><span class="line">    <span class="keyword">int</span> sh = it.f == it.s &amp;&amp; min (it.v1, it.v2) &gt; <span class="number">0</span>;</span><br><span class="line">                              </span><br><span class="line">    <span class="keyword">if</span> (it.v1) cnt = min (cnt, CC[pos[(<span class="keyword">int</span>) it.f]] &gt;&gt; sh);</span><br><span class="line">    <span class="keyword">if</span> (it.v2) cnt = min (cnt, CC[pos[(<span class="keyword">int</span>) it.s]] &gt;&gt; sh);</span><br><span class="line">    <span class="keyword">if</span> (!cnt) <span class="keyword">continue</span>;</span><br><span class="line">    </span><br><span class="line">    CC[pos[(<span class="keyword">int</span>) it.f]] -= cnt;</span><br><span class="line">    CC[pos[(<span class="keyword">int</span>) it.s]] -= cnt;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> nf = (pos[(<span class="keyword">int</span>) it.f] + it.v1) % alph.size ();</span><br><span class="line">    <span class="keyword">int</span> ns = (pos[(<span class="keyword">int</span>) it.s] + it.v2) % alph.size ();</span><br><span class="line">    </span><br><span class="line">    CC[nf] += cnt;</span><br><span class="line">    CC[ns] += cnt;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; F, S;</span><br><span class="line">                                               </span><br><span class="line">    <span class="keyword">if</span> (it.v1) &#123;             </span><br><span class="line">      F = change (pos[(<span class="keyword">int</span>) it.f], it.v1, cnt);   </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (it.v2) &#123;</span><br><span class="line">      S = change (pos[(<span class="keyword">int</span>) it.s], it.v2, cnt);   </span><br><span class="line">    &#125;                                                  </span><br><span class="line">    push ((pos[(<span class="keyword">int</span>) it.f] + it.v1) % alph.size (), F);</span><br><span class="line">    push ((pos[(<span class="keyword">int</span>) it.s] + it.v2) % alph.size (), S); </span><br><span class="line"></span><br><span class="line">    diff -= cnt * it.add;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">recoveryDec</span> <span class="params">(<span class="keyword">int</span> diff)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> it : Q) &#123;</span><br><span class="line">    <span class="keyword">if</span> (it.add &gt; <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span> (it.add &lt; diff) <span class="keyword">continue</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> cnt = diff / it.add;</span><br><span class="line">    <span class="keyword">int</span> sh = it.f == it.s &amp;&amp; min (it.v1, it.v2) &gt; <span class="number">0</span>;                          </span><br><span class="line">    <span class="keyword">if</span> (it.v1) cnt = min (cnt, CC[pos[(<span class="keyword">int</span>) it.f]] &gt;&gt; sh);</span><br><span class="line">    <span class="keyword">if</span> (it.v2) cnt = min (cnt, CC[pos[(<span class="keyword">int</span>) it.s]] &gt;&gt; sh);</span><br><span class="line">    <span class="keyword">if</span> (!cnt) <span class="keyword">continue</span>;</span><br><span class="line">    </span><br><span class="line">    CC[pos[(<span class="keyword">int</span>) it.f]] -= cnt;</span><br><span class="line">    CC[pos[(<span class="keyword">int</span>) it.s]] -= cnt;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> nf = (pos[(<span class="keyword">int</span>) it.f] + it.v1) % alph.size ();</span><br><span class="line">    <span class="keyword">int</span> ns = (pos[(<span class="keyword">int</span>) it.s] + it.v2) % alph.size ();</span><br><span class="line">    </span><br><span class="line">    CC[nf] += cnt;</span><br><span class="line">    CC[ns] += cnt;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; F, S;</span><br><span class="line">                                               </span><br><span class="line">    <span class="keyword">if</span> (it.v1) &#123;             </span><br><span class="line">      F = change (pos[(<span class="keyword">int</span>) it.f], it.v1, cnt);   </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (it.v2) &#123;</span><br><span class="line">      S = change (pos[(<span class="keyword">int</span>) it.s], it.v2, cnt);   </span><br><span class="line">    &#125;                                                  </span><br><span class="line">    push ((pos[(<span class="keyword">int</span>) it.f] + it.v1) % alph.size (), F);</span><br><span class="line">    push ((pos[(<span class="keyword">int</span>) it.s] + it.v2) % alph.size (), S); </span><br><span class="line"></span><br><span class="line">    diff -= cnt * it.add;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">recovery</span> <span class="params">(<span class="keyword">int</span> diff)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) s.size (); i++) &#123;</span><br><span class="line">    <span class="keyword">char</span> c = s[i];</span><br><span class="line">    PS[pos[(<span class="keyword">int</span>) c]].pb (i); </span><br><span class="line">  &#125; </span><br><span class="line">  <span class="keyword">if</span> (diff &lt; <span class="number">0</span>) recoveryDec (diff);</span><br><span class="line">  <span class="keyword">else</span> recoveryInc (diff);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getAnsInc</span> <span class="params">(<span class="keyword">int</span> diff)</span> </span>&#123;</span><br><span class="line">  <span class="comment">//clog &lt;&lt; "Inc" &lt;&lt; endl;</span></span><br><span class="line">  <span class="comment">//clog &lt;&lt; diff &lt;&lt; endl;</span></span><br><span class="line">  <span class="keyword">auto</span> tmpC = CC;</span><br><span class="line">  <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> it : Q) &#123;</span><br><span class="line">    <span class="keyword">if</span> (it.add &lt; <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span> (it.add &gt; diff) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">int</span> cnt = diff / it.add; </span><br><span class="line">    <span class="keyword">int</span> sh = it.f == it.s &amp;&amp; min (it.v1, it.v2) &gt; <span class="number">0</span>;                         </span><br><span class="line">    <span class="keyword">if</span> (it.v1) cnt = min (cnt, tmpC[pos[(<span class="keyword">int</span>) it.f]] &gt;&gt; sh);</span><br><span class="line">    <span class="keyword">if</span> (it.v2) cnt = min (cnt, tmpC[pos[(<span class="keyword">int</span>) it.s]] &gt;&gt; sh);</span><br><span class="line">    <span class="keyword">if</span> (!cnt) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="comment">//clog &lt;&lt; it &lt;&lt; ' ' &lt;&lt; cnt &lt;&lt; endl;</span></span><br><span class="line">    tmpC[pos[(<span class="keyword">int</span>) it.f]] -= cnt;</span><br><span class="line">    tmpC[pos[(<span class="keyword">int</span>) it.s]] -= cnt;</span><br><span class="line">    <span class="keyword">int</span> nf = (pos[(<span class="keyword">int</span>) it.f] + it.v1) % alph.size ();</span><br><span class="line">    <span class="keyword">int</span> ns = (pos[(<span class="keyword">int</span>) it.s] + it.v2) % alph.size ();</span><br><span class="line">    <span class="comment">//clog &lt;&lt; alph[nf] &lt;&lt; ' ' &lt;&lt; alph[ns] &lt;&lt; endl;</span></span><br><span class="line">    tmpC[nf] += cnt;</span><br><span class="line">    tmpC[ns] += cnt;</span><br><span class="line">    res += cnt * it.cost;</span><br><span class="line">    diff -= cnt * it.add;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getAnsDec</span> <span class="params">(<span class="keyword">int</span> diff)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">auto</span> tmpC = CC;</span><br><span class="line">  <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> it : Q) &#123;</span><br><span class="line">    <span class="keyword">if</span> (it.add &gt; <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span> (it.add &lt; diff) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">int</span> cnt = diff / it.add; </span><br><span class="line">    <span class="keyword">int</span> sh = it.f == it.s &amp;&amp; min (it.v1, it.v2) &gt; <span class="number">0</span>;                         </span><br><span class="line">    <span class="keyword">if</span> (it.v1) cnt = min (cnt, tmpC[pos[(<span class="keyword">int</span>) it.f]] &gt;&gt; sh);</span><br><span class="line">    <span class="keyword">if</span> (it.v2) cnt = min (cnt, tmpC[pos[(<span class="keyword">int</span>) it.s]] &gt;&gt; sh);</span><br><span class="line">    <span class="keyword">if</span> (!cnt) <span class="keyword">continue</span>;</span><br><span class="line">    tmpC[pos[(<span class="keyword">int</span>) it.f]] -= cnt;</span><br><span class="line">    tmpC[pos[(<span class="keyword">int</span>) it.s]] -= cnt;</span><br><span class="line">    <span class="keyword">int</span> nf = (pos[(<span class="keyword">int</span>) it.f] + it.v1) % alph.size ();</span><br><span class="line">    <span class="keyword">int</span> ns = (pos[(<span class="keyword">int</span>) it.s] + it.v2) % alph.size ();</span><br><span class="line">    tmpC[nf] += cnt;</span><br><span class="line">    tmpC[ns] += cnt;</span><br><span class="line">    res += cnt * it.cost;</span><br><span class="line">    diff -= cnt * it.add;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getAnsOdd</span> <span class="params">(<span class="keyword">int</span> diff)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> best = <span class="number">1e9</span>;</span><br><span class="line">  <span class="keyword">char</span> f = <span class="number">-1</span>, s = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> c : alph) &#123;</span><br><span class="line">    <span class="keyword">if</span> (CC[pos[(<span class="keyword">int</span>) c]] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">int</span> C = cnt[(<span class="keyword">int</span>) c];</span><br><span class="line">    <span class="keyword">int</span> bst = <span class="number">1e9</span>;</span><br><span class="line">    <span class="keyword">char</span> to = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> c2 : alph) &#123;</span><br><span class="line">      <span class="keyword">int</span> df = <span class="built_in">abs</span> (C - cnt[(<span class="keyword">int</span>) c2]);</span><br><span class="line">      <span class="keyword">if</span> (!(df &amp; <span class="number">1</span>)) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">if</span> (bst &gt; getDst (c, c2)) &#123;</span><br><span class="line">        bst = getDst (c, c2);</span><br><span class="line">        to = c2;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> ans = getDst (c, to);</span><br><span class="line">    CC[pos[(<span class="keyword">int</span>) c]]--;</span><br><span class="line">    CC[pos[(<span class="keyword">int</span>) to]]++;</span><br><span class="line">    <span class="keyword">int</span> CH = cnt[(<span class="keyword">int</span>) to] - cnt[(<span class="keyword">int</span>) c]; </span><br><span class="line">    <span class="comment">//clog &lt;&lt; "change one : " &lt;&lt; c &lt;&lt; ' ' &lt;&lt; to &lt;&lt; endl;</span></span><br><span class="line">    <span class="keyword">if</span> (diff - CH &lt; <span class="number">0</span>) ans += getAnsDec (diff - CH);  </span><br><span class="line">    <span class="keyword">else</span> ans += getAnsInc (diff - CH);</span><br><span class="line">    CC[pos[(<span class="keyword">int</span>) c]]++;</span><br><span class="line">    CC[pos[(<span class="keyword">int</span>) to]]--;</span><br><span class="line">    <span class="keyword">if</span> (ans &lt; best) &#123;</span><br><span class="line">      best = ans;</span><br><span class="line">      f = c;</span><br><span class="line">      s = to;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//clog &lt;&lt; f &lt;&lt; ' ' &lt;&lt; s &lt;&lt; endl;</span></span><br><span class="line">  CC[pos[(<span class="keyword">int</span>) f]]--;</span><br><span class="line">  CC[pos[(<span class="keyword">int</span>) s]]++;</span><br><span class="line">  <span class="keyword">int</span> CH = cnt[(<span class="keyword">int</span>) s] - cnt[(<span class="keyword">int</span>) f];</span><br><span class="line">  diff -= CH; </span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>) ::s.size (); i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (::s[i] == f) &#123;</span><br><span class="line">      change (i, getDst (f, s));</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  recovery (diff);</span><br><span class="line">  ans = best;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getAns</span> <span class="params">(<span class="keyword">int</span> diff)</span> </span>&#123;</span><br><span class="line">  <span class="comment">//clog &lt;&lt; diff &lt;&lt; endl;</span></span><br><span class="line">  <span class="keyword">if</span> (diff == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">abs</span> (diff) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">    getAnsOdd (diff);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (diff &lt; <span class="number">0</span>) ans = getAnsDec (diff);</span><br><span class="line">  <span class="keyword">else</span> ans = getAnsInc (diff);</span><br><span class="line">  recovery (diff);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (k &lt; <span class="number">0</span> || k &gt; <span class="number">2</span> * n) &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125; </span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> cur = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> c : s) &#123;</span><br><span class="line">    cur += cnt[(<span class="keyword">int</span>) c];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  build ();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> diff = k - cur;</span><br><span class="line"></span><br><span class="line">  getAns (diff);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; s &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  ios_base::sync_with_stdio (<span class="literal">false</span>);</span><br><span class="line">  <span class="built_in">cin</span>.tie (<span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">  pre ();</span><br><span class="line">  load ();</span><br><span class="line">  solve ();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/04/24/opentrains-1474训练记录/" rel="next" title="opentrains 1474训练记录">
                <i class="fa fa-chevron-left"></i> opentrains 1474训练记录
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">hdmmblz</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">6</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">4</span>
                    <span class="site-state-item-name">标签</span>
                  
                </div>
              
            </nav>
          

          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#opentrains-1483-E-Expected-LCP"><span class="nav-number">1.</span> <span class="nav-text">opentrains 1483 E.Expected LCP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#opentrains-1538-I-Modulo-magic-squares"><span class="nav-number">2.</span> <span class="nav-text">opentrains 1538 I.Modulo-magic squares</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Atcoder-AGC010"><span class="nav-number">3.</span> <span class="nav-text">Atcoder AGC010</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#opentrains1519"><span class="nav-number">4.</span> <span class="nav-text">opentrains1519</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#K-Knapsack"><span class="nav-number">4.1.</span> <span class="nav-text">K.Knapsack</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#I-Statistics"><span class="nav-number">4.2.</span> <span class="nav-text">I.Statistics</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#C-Flip-a-coin"><span class="nav-number">4.3.</span> <span class="nav-text">C.Flip a coin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#E-Tree-Paths"><span class="nav-number">4.4.</span> <span class="nav-text">E.Tree Paths</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#J-Zigzag"><span class="nav-number">4.5.</span> <span class="nav-text">J.Zigzag</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#opentrains1505-1491-1483"><span class="nav-number">5.</span> <span class="nav-text">opentrains1505/1491/1483</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#历史遗留问题："><span class="nav-number">6.</span> <span class="nav-text">历史遗留问题：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#opentrains1538J-Count-the-sequences"><span class="nav-number">7.</span> <span class="nav-text">opentrains1538J Count the sequences</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#opentrains1538G-String-transformation"><span class="nav-number">8.</span> <span class="nav-text">opentrains1538G String transformation</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-hdmmblz"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">hdmmblz</span>

  

  
</div>









        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.0"></script>

  <script src="/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/js/affix.js?v=7.1.0"></script>

  <script src="/js/schemes/pisces.js?v=7.1.0"></script>




  
  <script src="/js/scrollspy.js?v=7.1.0"></script>
<script src="/js/post-details.js?v=7.1.0"></script>



  


  <script src="/js/next-boot.js?v=7.1.0"></script>


  

  

  

  


  


  




  

  

  
  

  
  

  
    
      <script type="text/x-mathjax-config">
  

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });
  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') { next = next.nextSibling }
        if (next && next.nodeName.toLowerCase() === 'br') { next.parentNode.removeChild(next) }
      }
    });
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      document.getElementById(all[i].inputID + '-Frame').parentNode.className += ' has-jax';
    }
  });
</script>
<script src="//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    
  


  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
